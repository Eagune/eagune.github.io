<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title></title><link href="/demo/vendor.css" rel="stylesheet"><link href="/demo/client.css" rel="stylesheet"></head><body><div id="app"></div><script>window.HtmlCode='',window.HtmlFold=[],window.CssCode="",window.CssFold=[],window.JsCode="function parsePath(path) {\n  const segments = path.split('.') //闭包保存层级数组\n  return function(obj) {\n    for (let i = 0; i < segments.length; i++) {\n      if (!obj) return;\n      obj = obj[segments[i]];\n    }\n    return obj;\n  }\n}\nfunction isObject (obj) {\n  return obj !== null && typeof obj === 'object'\n}\nfunction extend (to, from) {\n  var keys = Object.keys(from)\n  var i = keys.length\n  while (i--) {\n    to[keys[i]] = from[keys[i]]\n  }\n  return to\n}\nfunction Watcher (vm, expOrFn, cb, options) {\n  if (options) {\n    extend(this, options)\n  }\n  this.vm = vm\n  this.expression = expOrFn\n  this.cb = cb\n  if (typeof expOrFn === 'function') {\n    this.getter = expOrFn\n  } else {\n    this.getter = parsePath(expOrFn)\n  }\n  this.value = this.getter.call(this.vm, this.vm)\n  this.shallow = false\n}\nWatcher.prototype.get = function () {\n  window.target = this\n  var value = this.getter.call(this.vm, this.vm)\n  window.target = null\n  return value\n}\nWatcher.prototype.update = function () {\n  var value = this.get()\n  if (\n    value !== this.value ||\n    ((isObject(value) || this.deep) && !this.shallow)\n  ) {\n    var oldValue = this.value\n    this.value = value\n    this.cb.call(this.vm, value, oldValue)\n  }\n}\n\nfunction defineReactive(data, key, value) {\n  var watcher;\n  Object.defineProperty(data, key, {\n    enumerable: true,\n    configurable: true,\n    get: function() {\n      if(window.target){\n         watcher = window.target\n      }\n      return value;\n    },\n    set: function(newVal) {\n      if (value === newVal) {\n        return;\n      }\n      value = newVal;\n      if (watcher) {\n          watcher.update()\n      }\n    }\n  });\n}\n\nvar data = {\n  name: 'Jhon'\n}\ndefineReactive(data, 'name', data['name'])\n\nvar watcher = new Watcher(data, 'name', function(newName){\n  console.log(newName)\n})\nwatcher.get()\ndata.name = 'Bob'",window.JsFold=[0,10,13,21,36,42]</script><script type="text/javascript" src="/demo/manifest.js"></script><script type="text/javascript" src="/demo/vendor.js"></script><script type="text/javascript" src="/demo/client.js"></script></body></html>