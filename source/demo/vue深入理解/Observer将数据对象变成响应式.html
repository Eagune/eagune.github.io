<!DOCTYPE html><html><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title></title><link href="/demo/vendor.css" rel="stylesheet"><link href="/demo/client.css" rel="stylesheet"></head><body><div id="app"></div><script>window.HtmlCode="",window.CssCode="",window.JsCode="class Observer {\n  constructor(value) {\n    this.value = value;\n\n    if (!Array.isArray(value)) {\n      this.walk(value);\n    } else {\n      value.__proto__ = arrayMethods;\n    }\n  }\n\n  walk(object) {\n    for (let key in object) {\n      defineReactive(object, key, object[key]);\n    }\n  }\n}\n\nconst arrayProto = Array.prototype;\nconst arrayMethods = Object.create(arrayProto);\n[\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'sort',\n  'reverse'\n].forEach(function(method) {\n  const original = arrayProto[method];\n  Object.defineProperty(arrayMethods, method, {\n    value: function mutator(...args) {\n      console.log('拦截数据 ' + args);\n      return original.apply(this, args)\n    },\n    enumerable: false,\n    writable: true,\n    configurable: true,\n  })\n})\n\nfunction defineReactive(data, key, value) {\n  if (typeof value === 'object') {\n    new Observer(value);\n  }\n  Object.defineProperty(data, key, {\n    enumerable: true,\n    configurable: true,\n    get: function() {\n      return value;\n    },\n    set: function(newVal) {\n      if (value === newVal) {\n        return;\n      }\n      console.log(key + ' 改变了');\n      if (typeof newVal === 'object') {\n        new Observer(newVal);\n      }\n      value = newVal;\n    }\n  });\n}\n\nvar data = {\n  name: 'Jhon',\n  skill: [],\n};\n\nnew Observer(data);\ndata.name = 'Tom';\ndata.skill.push('Write');\ndata.skill.push('Read');\ndata.skill = ['1', '2'];\ndata.skill.push('Write');\ndata.skill.push('Read');"</script><script type="text/javascript" src="/demo/manifest.js"></script><script type="text/javascript" src="/demo/vendor.js"></script><script type="text/javascript" src="/demo/client.js"></script></body></html>